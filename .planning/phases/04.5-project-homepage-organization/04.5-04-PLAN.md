---
phase: 04.5-project-homepage-organization
plan: 04
type: execute
wave: 3
depends_on: ["04.5-03"]
files_modified:
  - src/renderer/styles/globals.css
  - src/renderer/components/ui/sidebar.tsx
  - src/renderer/components/ui/card.tsx
  - src/renderer/components/ui/dialog.tsx
  - src/renderer/components/ui/scroll-area.tsx
  - src/renderer/components/ui/separator.tsx
  - src/renderer/components/ui/tooltip.tsx
  - src/renderer/components/sidebar/AppSidebar.tsx
  - src/renderer/components/dashboard/StatsStrip.tsx
  - src/renderer/components/dashboard/ProjectCard.tsx
  - src/renderer/components/dashboard/ProjectGrid.tsx
  - src/renderer/components/dashboard/CreateProjectDialog.tsx
  - src/renderer/routes/Dashboard.tsx
  - src/renderer/App.tsx
autonomous: true

must_haves:
  truths:
    - "Sidebar navigation with collapsible icon-only mode"
    - "Stats strip shows CVs processed, JDs, and time saved metrics"
    - "Project cards display in 3-column grid"
    - "Project card shows name, client, CV count, JD count, last activity"
    - "Create project dialog captures name and optional client/description"
    - "Dashboard follows dark theme styling"
  artifacts:
    - path: "src/renderer/components/sidebar/AppSidebar.tsx"
      provides: "Collapsible navigation sidebar"
      min_lines: 40
    - path: "src/renderer/components/dashboard/StatsStrip.tsx"
      provides: "Aggregate metrics display"
      min_lines: 30
    - path: "src/renderer/components/dashboard/ProjectCard.tsx"
      provides: "Individual project card component"
      min_lines: 40
    - path: "src/renderer/components/dashboard/CreateProjectDialog.tsx"
      provides: "Project creation modal"
      min_lines: 50
  key_links:
    - from: "src/renderer/routes/Dashboard.tsx"
      to: "src/renderer/components/dashboard/*"
      via: "imports and renders"
    - from: "src/renderer/App.tsx"
      to: "src/renderer/components/sidebar/AppSidebar.tsx"
      via: "SidebarProvider wraps routes"
---

<objective>
Build the dashboard UI with sidebar navigation, stats strip, and project cards.

Purpose: Create a professional dashboard experience matching the PlanRadar reference style. Users see aggregate stats and can browse/create projects.

Output: shadcn/ui components (sidebar, card, dialog), AppSidebar, StatsStrip, ProjectCard, ProjectGrid, CreateProjectDialog, and updated Dashboard route.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04.5-project-homepage-organization/04.5-CONTEXT.md
@.planning/phases/04.5-project-homepage-organization/04.5-RESEARCH.md
@src/renderer/routes/Dashboard.tsx
@src/renderer/App.tsx
@src/renderer/styles/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install shadcn/ui components and add sidebar CSS variables</name>
  <files>src/renderer/styles/globals.css, src/renderer/components/ui/*.tsx</files>
  <action>
1. Install shadcn/ui components:
```bash
npx shadcn@latest add sidebar card dialog scroll-area separator tooltip
```

When prompted:
- If asked about overwriting existing components, choose "no" to preserve existing button/badge/tabs/input
- Accept defaults for new components

2. Add sidebar CSS variables to `src/renderer/styles/globals.css`:

After the existing `:root` variables (around line 10-30), add sidebar-specific variables:
```css
  /* Sidebar - dark theme matching terminal aesthetic */
  --sidebar: 0 0% 5%;
  --sidebar-foreground: 0 0% 100%;
  --sidebar-primary: 280 100% 60%;
  --sidebar-primary-foreground: 0 0% 100%;
  --sidebar-accent: 0 0% 15%;
  --sidebar-accent-foreground: 0 0% 100%;
  --sidebar-border: 0 0% 20%;
  --sidebar-ring: 280 100% 60%;
```

Note: These should be inside the existing `:root` block (or `.dark` if using that pattern).

3. Verify the shadcn components are installed:
- src/renderer/components/ui/sidebar.tsx
- src/renderer/components/ui/card.tsx
- src/renderer/components/ui/dialog.tsx
- src/renderer/components/ui/scroll-area.tsx
- src/renderer/components/ui/separator.tsx
- src/renderer/components/ui/tooltip.tsx
  </action>
  <verify>
- All 6 shadcn component files exist in src/renderer/components/ui/
- globals.css has sidebar CSS variables
- TypeScript compiles without errors
  </verify>
  <done>shadcn/ui sidebar, card, dialog components installed with dark theme CSS variables</done>
</task>

<task type="auto">
  <name>Task 2: Create AppSidebar and dashboard components</name>
  <files>src/renderer/components/sidebar/AppSidebar.tsx, src/renderer/components/dashboard/StatsStrip.tsx, src/renderer/components/dashboard/ProjectCard.tsx, src/renderer/components/dashboard/CreateProjectDialog.tsx, src/renderer/components/dashboard/index.ts</files>
  <action>
1. Create `src/renderer/components/sidebar/AppSidebar.tsx`:
```typescript
import { useNavigate, useLocation } from 'react-router-dom';
import { LayoutDashboard, Settings } from 'lucide-react';
import {
  Sidebar,
  SidebarContent,
  SidebarGroup,
  SidebarGroupContent,
  SidebarMenu,
  SidebarMenuItem,
  SidebarMenuButton,
  SidebarHeader,
  SidebarFooter,
} from '../ui/sidebar';

const navItems = [
  { title: 'Dashboard', icon: LayoutDashboard, path: '/' },
];

export function AppSidebar() {
  const navigate = useNavigate();
  const location = useLocation();

  return (
    <Sidebar collapsible="icon">
      <SidebarHeader className="p-4">
        <span className="text-lg font-bold text-primary">Samsara</span>
      </SidebarHeader>

      <SidebarContent>
        <SidebarGroup>
          <SidebarGroupContent>
            <SidebarMenu>
              {navItems.map((item) => (
                <SidebarMenuItem key={item.title}>
                  <SidebarMenuButton
                    onClick={() => navigate(item.path)}
                    isActive={location.pathname === item.path}
                    tooltip={item.title}
                  >
                    <item.icon />
                    <span>{item.title}</span>
                  </SidebarMenuButton>
                </SidebarMenuItem>
              ))}
            </SidebarMenu>
          </SidebarGroupContent>
        </SidebarGroup>
      </SidebarContent>

      <SidebarFooter className="p-2">
        <SidebarMenu>
          <SidebarMenuItem>
            <SidebarMenuButton tooltip="Settings">
              <Settings />
              <span>Settings</span>
            </SidebarMenuButton>
          </SidebarMenuItem>
        </SidebarMenu>
      </SidebarFooter>
    </Sidebar>
  );
}
```

2. Create `src/renderer/components/dashboard/StatsStrip.tsx`:
```typescript
import { Card, CardContent } from '../ui/card';
import { FileText, Briefcase, Clock } from 'lucide-react';

interface StatsStripProps {
  totalCVs: number;
  totalJDs: number;
  timeSaved: string;
}

export function StatsStrip({ totalCVs, totalJDs, timeSaved }: StatsStripProps) {
  const stats = [
    { label: 'CVs Processed', value: totalCVs, icon: FileText },
    { label: 'Job Descriptions', value: totalJDs, icon: Briefcase },
    { label: 'Time Saved', value: timeSaved, icon: Clock },
  ];

  return (
    <div className="flex gap-4 p-4 border-b border-border">
      {stats.map((stat) => (
        <Card key={stat.label} className="flex-1 bg-card border-border">
          <CardContent className="flex items-center gap-3 p-4">
            <stat.icon className="h-8 w-8 text-primary" />
            <div>
              <p className="text-2xl font-bold">{stat.value}</p>
              <p className="text-xs text-muted-foreground">{stat.label}</p>
            </div>
          </CardContent>
        </Card>
      ))}
    </div>
  );
}
```

3. Create `src/renderer/components/dashboard/ProjectCard.tsx`:
```typescript
import { useNavigate } from 'react-router-dom';
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from '../ui/card';
import { Button } from '../ui/button';
import { MoreHorizontal, Archive, Trash2 } from 'lucide-react';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from '../ui/dropdown-menu';
import type { Project } from '../../types/project';

interface ProjectCardProps {
  project: Project;
  onArchive: (id: string) => void;
  onDelete: (id: string) => void;
}

export function ProjectCard({ project, onArchive, onDelete }: ProjectCardProps) {
  const navigate = useNavigate();

  const formatDate = (dateStr: string) => {
    const date = new Date(dateStr);
    return date.toLocaleDateString('en-GB', {
      day: 'numeric',
      month: 'short',
      year: 'numeric',
    });
  };

  return (
    <Card
      className="bg-card border-border hover:border-primary cursor-pointer transition-colors"
      onClick={() => navigate(`/project/${project.id}`)}
    >
      <CardHeader className="flex flex-row items-start justify-between space-y-0 pb-2">
        <div className="space-y-1">
          <CardTitle className="text-lg font-medium">{project.name}</CardTitle>
          {project.client_name && (
            <CardDescription className="text-sm">{project.client_name}</CardDescription>
          )}
        </div>
        <DropdownMenu>
          <DropdownMenuTrigger asChild onClick={(e) => e.stopPropagation()}>
            <Button variant="ghost" size="icon" className="h-8 w-8">
              <MoreHorizontal className="h-4 w-4" />
            </Button>
          </DropdownMenuTrigger>
          <DropdownMenuContent align="end">
            <DropdownMenuItem onClick={(e) => { e.stopPropagation(); onArchive(project.id); }}>
              <Archive className="mr-2 h-4 w-4" />
              Archive
            </DropdownMenuItem>
            <DropdownMenuItem
              onClick={(e) => { e.stopPropagation(); onDelete(project.id); }}
              className="text-destructive focus:text-destructive"
            >
              <Trash2 className="mr-2 h-4 w-4" />
              Delete
            </DropdownMenuItem>
          </DropdownMenuContent>
        </DropdownMenu>
      </CardHeader>
      <CardContent>
        <div className="flex gap-4 text-sm text-muted-foreground">
          <span>{project.cv_count} CVs</span>
          <span>{project.jd_count} JDs</span>
        </div>
        <p className="text-xs text-muted-foreground mt-2">
          Last activity: {formatDate(project.updated_at)}
        </p>
      </CardContent>
    </Card>
  );
}
```

NOTE: You'll need to install dropdown-menu component:
```bash
npx shadcn@latest add dropdown-menu
```

4. Create `src/renderer/components/dashboard/CreateProjectDialog.tsx`:
```typescript
import { useState } from 'react';
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
} from '../ui/dialog';
import { Button } from '../ui/button';
import { Input } from '../ui/input';

interface CreateProjectDialogProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  onCreate: (data: { name: string; client_name?: string; description?: string }) => Promise<void>;
}

export function CreateProjectDialog({ open, onOpenChange, onCreate }: CreateProjectDialogProps) {
  const [name, setName] = useState('');
  const [clientName, setClientName] = useState('');
  const [description, setDescription] = useState('');
  const [isCreating, setIsCreating] = useState(false);

  const handleCreate = async () => {
    if (!name.trim()) return;

    setIsCreating(true);
    try {
      await onCreate({
        name: name.trim(),
        client_name: clientName.trim() || undefined,
        description: description.trim() || undefined,
      });
      // Reset form
      setName('');
      setClientName('');
      setDescription('');
      onOpenChange(false);
    } catch (error) {
      console.error('Failed to create project:', error);
    } finally {
      setIsCreating(false);
    }
  };

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="sm:max-w-[425px]">
        <DialogHeader>
          <DialogTitle>Create Project</DialogTitle>
          <DialogDescription>
            Create a new project to organize your CVs and job descriptions.
          </DialogDescription>
        </DialogHeader>
        <div className="grid gap-4 py-4">
          <div className="space-y-2">
            <label htmlFor="name" className="text-sm font-medium">
              Project Name <span className="text-destructive">*</span>
            </label>
            <Input
              id="name"
              value={name}
              onChange={(e) => setName(e.target.value)}
              placeholder="e.g., Senior Developer Role"
              autoFocus
            />
          </div>
          <div className="space-y-2">
            <label htmlFor="client" className="text-sm font-medium">
              Client Name
            </label>
            <Input
              id="client"
              value={clientName}
              onChange={(e) => setClientName(e.target.value)}
              placeholder="e.g., Acme Corp (optional)"
            />
          </div>
          <div className="space-y-2">
            <label htmlFor="description" className="text-sm font-medium">
              Description
            </label>
            <Input
              id="description"
              value={description}
              onChange={(e) => setDescription(e.target.value)}
              placeholder="Brief description (optional)"
            />
          </div>
        </div>
        <DialogFooter>
          <Button variant="outline" onClick={() => onOpenChange(false)} disabled={isCreating}>
            Cancel
          </Button>
          <Button onClick={handleCreate} disabled={!name.trim() || isCreating}>
            {isCreating ? 'Creating...' : 'Create Project'}
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
}
```

5. Create `src/renderer/components/dashboard/index.ts`:
```typescript
export { StatsStrip } from './StatsStrip';
export { ProjectCard } from './ProjectCard';
export { CreateProjectDialog } from './CreateProjectDialog';
```
  </action>
  <verify>
- All component files exist in correct directories
- TypeScript compiles without errors
- Components export correctly from index.ts
  </verify>
  <done>Dashboard components created: AppSidebar, StatsStrip, ProjectCard, CreateProjectDialog</done>
</task>

<task type="auto">
  <name>Task 3: Update Dashboard route and App with sidebar layout</name>
  <files>src/renderer/routes/Dashboard.tsx, src/renderer/App.tsx</files>
  <action>
1. Update `src/renderer/routes/Dashboard.tsx`:
```typescript
import { useEffect, useState } from 'react';
import { useNavigate } from 'react-router-dom';
import { Plus } from 'lucide-react';
import { useProjectStore } from '../stores/projectStore';
import { StatsStrip, ProjectCard, CreateProjectDialog } from '../components/dashboard';
import { Card, CardContent } from '../components/ui/card';

export function Dashboard() {
  const navigate = useNavigate();
  const { projects, isLoading, loadProjects, createProject, archiveProject, deleteProject } = useProjectStore();
  const [showCreateDialog, setShowCreateDialog] = useState(false);
  const [stats, setStats] = useState({ total_cvs: 0, total_jds: 0 });

  useEffect(() => {
    loadProjects();
    // Load aggregate stats
    window.api.getAggregateStats().then((result) => {
      if (result.success && result.data) {
        setStats(result.data);
      }
    });
  }, [loadProjects]);

  const handleCreateProject = async (data: { name: string; client_name?: string; description?: string }) => {
    const id = await createProject(data);
    navigate(`/project/${id}`);
  };

  const handleArchive = async (id: string) => {
    await archiveProject(id);
  };

  const handleDelete = async (id: string) => {
    if (window.confirm('Delete this project and all its data? This cannot be undone.')) {
      await deleteProject(id);
    }
  };

  // Calculate time saved (estimate: 5 min manual vs 2s automated per CV)
  const timeSavedMinutes = Math.round(stats.total_cvs * 4.97); // 5 min - 2s = ~4.97 min saved per CV
  const timeSavedFormatted = timeSavedMinutes >= 60
    ? `${Math.floor(timeSavedMinutes / 60)}h ${timeSavedMinutes % 60}m`
    : `${timeSavedMinutes}m`;

  if (isLoading) {
    return (
      <div className="flex-1 flex items-center justify-center">
        <p className="text-muted-foreground">Loading projects...</p>
      </div>
    );
  }

  return (
    <div className="flex-1 flex flex-col overflow-hidden">
      {/* Stats Strip */}
      <StatsStrip
        totalCVs={stats.total_cvs}
        totalJDs={stats.total_jds}
        timeSaved={timeSavedFormatted}
      />

      {/* Projects Grid */}
      <div className="flex-1 overflow-auto p-6">
        <h2 className="text-lg font-semibold mb-4">Projects</h2>
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          {/* Create New Project Card */}
          <Card
            className="bg-card border-border border-dashed hover:border-primary cursor-pointer transition-colors min-h-[140px] flex items-center justify-center"
            onClick={() => setShowCreateDialog(true)}
          >
            <CardContent className="flex flex-col items-center gap-2 p-6">
              <Plus className="h-8 w-8 text-muted-foreground" />
              <span className="text-sm text-muted-foreground">New Project</span>
            </CardContent>
          </Card>

          {/* Project Cards */}
          {projects.map((project) => (
            <ProjectCard
              key={project.id}
              project={project}
              onArchive={handleArchive}
              onDelete={handleDelete}
            />
          ))}
        </div>
      </div>

      {/* Create Project Dialog */}
      <CreateProjectDialog
        open={showCreateDialog}
        onOpenChange={setShowCreateDialog}
        onCreate={handleCreateProject}
      />
    </div>
  );
}
```

2. Update `src/renderer/App.tsx` to include sidebar layout:
```typescript
import { MemoryRouter, Routes, Route } from 'react-router-dom';
import { SidebarProvider, SidebarInset, SidebarTrigger } from './components/ui/sidebar';
import { AppSidebar } from './components/sidebar/AppSidebar';
import { Dashboard } from './routes/Dashboard';
import { ProjectView } from './routes/ProjectView';
import { TooltipProvider } from './components/ui/tooltip';
import './styles/globals.css';

export function App() {
  return (
    <MemoryRouter initialEntries={['/']}>
      <TooltipProvider>
        <SidebarProvider>
          <div className="flex h-screen w-full bg-background">
            <AppSidebar />
            <SidebarInset className="flex flex-col flex-1 overflow-hidden">
              <header className="flex items-center gap-2 px-4 py-2 border-b border-border">
                <SidebarTrigger />
              </header>
              <Routes>
                <Route path="/" element={<Dashboard />} />
                <Route path="/project/:id" element={<ProjectView />} />
              </Routes>
            </SidebarInset>
          </div>
        </SidebarProvider>
      </TooltipProvider>
    </MemoryRouter>
  );
}
```

3. Update `src/renderer/routes/ProjectView.tsx` to remove duplicate header (since App now provides it):
- Remove the outer header that has the "Dashboard" back button and project title
- Instead, update the header in ProjectView to show project-specific content inline with the sidebar trigger

Actually, let's keep ProjectView header separate but modify it to work within the SidebarInset layout:

```typescript
// In ProjectView.tsx, update to work within the sidebar layout
// Remove the outer div wrapper and header, as App.tsx now handles the main layout
// The component should start from the main content area

import { useEffect, useState } from 'react';
import { useParams, useNavigate } from 'react-router-dom';
import { QueueTabs } from '../components/queue/QueueTabs';
import { CVEditor } from '../components/editor/CVEditor';
import { ErrorDetailPanel } from '../components/editor/ErrorDetailPanel';
import { JDPanel } from '../components/jd/JDPanel';
import { LLMSettings } from '../components/settings/LLMSettings';
import { Button } from '../components/ui/button';
import { useQueueStore } from '../stores/queueStore';
import { useEditorStore } from '../stores/editorStore';
import { useJDStore } from '../stores/jdStore';
import { useProjectStore } from '../stores/projectStore';
import { ArrowLeft, Settings } from 'lucide-react';

export function ProjectView() {
  const { id: projectId } = useParams<{ id: string }>();
  const navigate = useNavigate();

  const loadFromDatabase = useQueueStore((state) => state.loadFromDatabase);
  const loadJDs = useJDStore((state) => state.loadJDs);
  const viewMode = useEditorStore((state) => state.viewMode);
  const { selectProject, projects } = useProjectStore();

  const [showSettings, setShowSettings] = useState(false);

  const currentProject = projects.find((p) => p.id === projectId);

  useEffect(() => {
    if (projectId) {
      selectProject(projectId);
    }
  }, [projectId, selectProject]);

  useEffect(() => {
    if (projectId) {
      loadFromDatabase();
      loadJDs();
    }
  }, [projectId, loadFromDatabase, loadJDs]);

  const isPanelOpen = viewMode !== null || showSettings;

  return (
    <>
      {/* Project-specific header bar */}
      <div className="flex items-center justify-between px-4 py-2 border-b border-border bg-background">
        <div className="flex items-center gap-3">
          <Button
            variant="ghost"
            size="sm"
            onClick={() => {
              selectProject(null);
              navigate('/');
            }}
          >
            <ArrowLeft className="h-4 w-4 mr-1" />
            Dashboard
          </Button>
          <div className="h-4 w-px bg-border" />
          <div>
            <span className="font-medium">{currentProject?.name || 'Project'}</span>
            {currentProject?.client_name && (
              <span className="text-muted-foreground ml-2">Â· {currentProject.client_name}</span>
            )}
          </div>
        </div>
        <Button
          variant="ghost"
          size="sm"
          onClick={() => setShowSettings(!showSettings)}
        >
          <Settings className="h-4 w-4" />
        </Button>
      </div>

      {/* Main content */}
      <main className="flex-1 overflow-hidden flex">
        <div data-testid="queue-panel" className={`border-r border-border ${isPanelOpen ? 'w-1/3' : 'w-1/2'}`}>
          <QueueTabs />
        </div>

        <div data-testid="jd-panel" className={`border-r border-border ${isPanelOpen ? 'w-1/3' : 'w-1/2'}`}>
          <JDPanel />
        </div>

        {showSettings && (
          <div className="w-1/3 border-l border-border">
            <div className="p-4 border-b border-border">
              <h2 className="text-sm font-medium text-foreground">Settings</h2>
            </div>
            <LLMSettings />
          </div>
        )}
        {!showSettings && viewMode === 'cv' && (
          <div className="w-1/3">
            <CVEditor />
          </div>
        )}
        {!showSettings && viewMode === 'error' && (
          <div className="w-1/3">
            <ErrorDetailPanel />
          </div>
        )}
      </main>
    </>
  );
}
```
  </action>
  <verify>
- TypeScript compiles without errors
- App launches with sidebar visible
- Dashboard shows stats strip and project cards grid
- Clicking "+" card opens create dialog
- Creating project navigates to project view
- Project view shows existing queue/JD/editor layout
- Sidebar collapses to icons on trigger click
  </verify>
  <done>Dashboard UI complete with sidebar, stats strip, project cards, and create dialog</done>
</task>

</tasks>

<verification>
1. `npm run build` completes without TypeScript errors
2. App launches with sidebar navigation on the left
3. Dashboard shows:
   - Stats strip with CVs Processed, Job Descriptions, Time Saved
   - Project grid with "+" create card and existing projects
4. Clicking sidebar collapse button toggles to icon-only mode
5. Click "+" opens create project dialog
6. Create project with name navigates to project view
7. Project view shows project header and existing queue/JD/editor layout
8. Back to Dashboard button returns to project list
9. Archive/Delete options work from project card menu
</verification>

<success_criteria>
- Sidebar navigation present and collapsible
- Stats strip shows aggregate metrics
- Project cards display in 3-column grid
- Create project dialog works with validation
- Full navigation flow: dashboard -> create -> project view -> dashboard
- Dark theme applied consistently
</success_criteria>

<output>
After completion, create `.planning/phases/04.5-project-homepage-organization/04.5-04-SUMMARY.md`
</output>
