---
phase: 04-jd-matching
plan: 03
type: execute
wave: 3
depends_on: ["04-02"]
files_modified:
  - package.json
  - src/renderer/components/jd/JDList.tsx
  - src/renderer/components/jd/JDPanel.tsx
  - src/renderer/components/jd/MatchResults.tsx
  - src/renderer/components/jd/SkillHighlight.tsx
  - src/renderer/components/jd/index.ts
  - src/renderer/components/editor/SkillsSection.tsx
  - src/renderer/App.tsx
autonomous: false

must_haves:
  truths:
    - "User can see a list of stored JDs and select one"
    - "User can select multiple CVs from queue using checkboxes and assign them to a JD for scoring"
    - "CVs appear in a ranked list ordered by match score with percentage displayed"
    - "Matched skills are visually highlighted when viewing a CV in context of a JD"
    - "Match quality indicators show Strong/Good/Partial/Weak match status"
  artifacts:
    - path: "src/renderer/components/jd/JDList.tsx"
      provides: "List of stored JDs with selection"
      contains: "JDList"
      min_lines: 40
    - path: "src/renderer/components/jd/JDPanel.tsx"
      provides: "JD panel with tabs for input, list, and results"
      contains: "JDPanel"
      min_lines: 60
    - path: "src/renderer/components/jd/MatchResults.tsx"
      provides: "Ranked CV list with scores and match indicators"
      contains: "MatchResults"
      min_lines: 60
    - path: "src/renderer/components/jd/SkillHighlight.tsx"
      provides: "Skill highlighting wrapper using react-highlight-words"
      contains: "SkillHighlight"
      min_lines: 25
    - path: "src/renderer/App.tsx"
      provides: "Integrated JD panel in app layout"
      contains: "JDPanel"
  key_links:
    - from: "src/renderer/components/jd/MatchResults.tsx"
      to: "src/renderer/stores/jdStore.ts"
      via: "useJDStore for match results"
      pattern: "useJDStore"
    - from: "src/renderer/components/jd/MatchResults.tsx"
      to: "src/renderer/stores/queueStore.ts"
      via: "useQueueStore for selectedIds from queue checkboxes"
      pattern: "useQueueStore.*selectedIds"
    - from: "src/renderer/components/editor/SkillsSection.tsx"
      to: "src/renderer/components/jd/SkillHighlight.tsx"
      via: "SkillHighlight wrapper for matched skills"
      pattern: "SkillHighlight"
---

<objective>
Create the ranked results view with skill highlighting for JD matching.

Purpose: Complete the JD matching feature by adding the visual layer - JD selection panel, ranked CV results with scores, and skill highlighting in the CV editor. This fulfills all M-01 requirements for the JD Matching phase.

Output:
- JD list and selection panel
- Match results view with ranked CVs and scores
- Skill highlighting component using react-highlight-words
- Integration into app layout
- Human verification checkpoint for full feature
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-jd-matching/04-RESEARCH.md
@.planning/phases/04-jd-matching/04-01-SUMMARY.md
@.planning/phases/04-jd-matching/04-02-SUMMARY.md

# Existing UI components to follow patterns
@src/renderer/App.tsx
@src/renderer/components/queue/QueueTabs.tsx
@src/renderer/components/editor/SkillsSection.tsx

# Stores for state - especially queueStore for selectedIds
@src/renderer/stores/jdStore.ts
@src/renderer/stores/queueStore.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install react-highlight-words and create highlighting component</name>
  <files>
    package.json
    src/renderer/components/jd/SkillHighlight.tsx
  </files>
  <action>
**1. Install react-highlight-words:**

```bash
npm install react-highlight-words
```

**2. Create `src/renderer/components/jd/SkillHighlight.tsx`:**

```tsx
import Highlighter from 'react-highlight-words';
import { getSkillVariants } from '../../lib/skillVariants';

interface SkillHighlightProps {
  text: string;
  matchedSkills: string[];
  className?: string;
}

/**
 * Highlights matched skills in text using react-highlight-words.
 * Expands skills to include their variants for comprehensive highlighting.
 */
export function SkillHighlight({ text, matchedSkills, className }: SkillHighlightProps) {
  // Expand each matched skill to include its known variants
  const searchWords = matchedSkills.flatMap(skill => {
    const variants = getSkillVariants(skill.toLowerCase());
    // Include the original skill plus any variants
    return variants.length > 0 ? variants : [skill.toLowerCase()];
  });

  // Remove duplicates
  const uniqueSearchWords = [...new Set(searchWords)];

  return (
    <Highlighter
      searchWords={uniqueSearchWords}
      autoEscape={true}
      textToHighlight={text}
      highlightClassName="bg-primary/30 text-primary font-medium px-0.5 rounded"
      className={className}
      caseSensitive={false}
    />
  );
}

/**
 * Highlights a single skill badge if it's in the matched list.
 */
export function HighlightedSkillBadge({
  skill,
  matchedSkills,
}: {
  skill: string;
  matchedSkills: string[];
}) {
  const isMatched = matchedSkills.some(matched => {
    const variants = getSkillVariants(matched.toLowerCase());
    const normalizedSkill = skill.toLowerCase();

    // Check exact match or variant match
    if (normalizedSkill === matched.toLowerCase()) return true;
    if (variants.includes(normalizedSkill)) return true;

    // Substring match
    if (normalizedSkill.includes(matched.toLowerCase()) ||
        matched.toLowerCase().includes(normalizedSkill)) {
      return true;
    }

    return false;
  });

  return (
    <span
      className={`
        inline-flex items-center px-2 py-0.5 rounded text-xs font-medium
        ${isMatched
          ? 'bg-primary/30 text-primary border border-primary/50'
          : 'bg-muted text-muted-foreground'
        }
      `}
    >
      {skill}
      {isMatched && (
        <span className="ml-1 text-[10px]" title="Matches JD requirement">
          *
        </span>
      )}
    </span>
  );
}
```
  </action>
  <verify>
```bash
cd "C:\Users\edwar\Documents\dev\Projects\Samsara"
# Verify package installed
grep "react-highlight-words" package.json

# Verify component compiles
npx tsc --noEmit src/renderer/components/jd/SkillHighlight.tsx 2>&1 | head -10
```
  </verify>
  <done>
- react-highlight-words installed as dependency
- SkillHighlight component wraps text with highlighting for matched skills
- HighlightedSkillBadge component for individual skill badges with match indication
- Both components use skill variants for comprehensive matching
  </done>
</task>

<task type="auto">
  <name>Task 2: Create JD list, match results (with queue checkbox integration), and panel components</name>
  <files>
    src/renderer/components/jd/JDList.tsx
    src/renderer/components/jd/MatchResults.tsx
    src/renderer/components/jd/JDPanel.tsx
    src/renderer/components/jd/index.ts
  </files>
  <action>
**1. Create `src/renderer/components/jd/JDList.tsx`:**

```tsx
import { useEffect } from 'react';
import { Button } from '../ui/button';
import { useJDStore } from '../../stores/jdStore';

export function JDList() {
  const { jds, activeJDId, loadJDs, selectJD, deleteJD } = useJDStore();

  useEffect(() => {
    loadJDs();
  }, [loadJDs]);

  if (jds.length === 0) {
    return (
      <div className="p-4 text-center text-muted-foreground">
        <p>No job descriptions yet.</p>
        <p className="text-sm mt-1">Paste a JD in the "Add JD" tab to get started.</p>
      </div>
    );
  }

  return (
    <div className="p-2 space-y-2">
      {jds.map((jd) => (
        <div
          key={jd.id}
          className={`
            p-3 rounded-md border cursor-pointer transition-colors
            ${activeJDId === jd.id
              ? 'border-primary bg-primary/10'
              : 'border-border hover:border-muted-foreground'
            }
          `}
          onClick={() => selectJD(jd.id)}
        >
          <div className="flex items-start justify-between">
            <div className="flex-1 min-w-0">
              <h3 className="font-medium text-foreground truncate">
                {jd.title}
              </h3>
              {jd.company && (
                <p className="text-sm text-muted-foreground truncate">
                  {jd.company}
                </p>
              )}
              <div className="flex gap-2 mt-1 text-xs text-muted-foreground">
                <span>{jd.required_count} required</span>
                <span>|</span>
                <span>{jd.preferred_count} preferred</span>
              </div>
            </div>
            <Button
              variant="ghost"
              size="sm"
              className="text-muted-foreground hover:text-destructive"
              onClick={(e) => {
                e.stopPropagation();
                deleteJD(jd.id);
              }}
            >
              Delete
            </Button>
          </div>
          <p className="text-xs text-muted-foreground mt-2">
            {new Date(jd.created_at).toLocaleDateString()}
          </p>
        </div>
      ))}
    </div>
  );
}
```

**2. Create `src/renderer/components/jd/MatchResults.tsx`:**

**IMPORTANT (M-01b):** This component implements CV selection for matching by reading `selectedIds` from `queueStore`. Users select CVs using the existing checkbox UI in the queue panel (QueueList component), which populates `selectedIds`. MatchResults then reads those selections via `useQueueStore((state) => state.selectedIds)` and passes them to the match function.

**CV Selection Workflow:**
1. User clicks checkboxes next to CVs in the Queue panel (left side) - this uses existing QueueList checkbox UI
2. Selected CV IDs are stored in queueStore.selectedIds (a Set)
3. MatchResults reads selectedIds via useQueueStore
4. "Match Selected" button passes selectedIds to jdStore.matchCVs()
5. After matching, clearSelection() clears the checkboxes

```tsx
import { useEffect } from 'react';
import { Button } from '../ui/button';
import { Badge } from '../ui/badge';
import { useJDStore } from '../../stores/jdStore';
import { useQueueStore } from '../../stores/queueStore';
import { useEditorStore } from '../../stores/editorStore';
import { getMatchQuality } from '../../lib/matchingEngine';

export function MatchResults() {
  const { activeJD, matchResults, matchCVs, loadMatchResults } = useJDStore();

  // Read selected CVs from queueStore - these are selected via checkboxes in QueueList
  // The existing QueueList component has checkbox UI that populates selectedIds
  const { items: queueItems, selectedIds, clearSelection } = useQueueStore();

  const { loadCV } = useEditorStore();

  // Load match results when JD changes
  useEffect(() => {
    if (activeJD) {
      loadMatchResults();
    }
  }, [activeJD?.id, loadMatchResults]);

  if (!activeJD) {
    return (
      <div className="p-4 text-center text-muted-foreground">
        <p>Select a job description to see match results.</p>
      </div>
    );
  }

  // Filter to only completed CVs (those that have been successfully parsed)
  const completedCVs = queueItems.filter(i => i.status === 'completed');

  // Get the intersection of selectedIds and completedCVs
  // selectedIds comes from checkboxes in QueueList component
  const selectedCVIds = [...selectedIds].filter(id =>
    completedCVs.some(cv => cv.id === id)
  );

  // Match selected CVs - uses IDs from queue checkboxes
  const handleMatchSelected = async () => {
    if (selectedCVIds.length === 0) return;
    await matchCVs(selectedCVIds);
    clearSelection();  // Clear queue checkboxes after matching
  };

  // Match all completed CVs
  const handleMatchAll = async () => {
    const allIds = completedCVs.map(cv => cv.id);
    await matchCVs(allIds);
  };

  // Get CV file name from queue items
  const getCVFileName = (cvId: string) => {
    const item = queueItems.find(i => i.id === cvId);
    return item?.fileName || 'Unknown CV';
  };

  return (
    <div className="flex flex-col h-full">
      {/* Header with JD info */}
      <div className="p-4 border-b border-border">
        <h3 className="font-medium text-foreground">{activeJD.title}</h3>
        {activeJD.company && (
          <p className="text-sm text-muted-foreground">{activeJD.company}</p>
        )}
        <div className="flex gap-2 mt-2">
          <Badge variant="outline">
            {activeJD.required_skills.length} required
          </Badge>
          <Badge variant="outline">
            {activeJD.preferred_skills.length} preferred
          </Badge>
        </div>
      </div>

      {/* Match actions - explains the CV selection workflow */}
      <div className="p-4 border-b border-border space-y-2">
        <div className="flex gap-2">
          <Button
            size="sm"
            variant="outline"
            onClick={handleMatchSelected}
            disabled={selectedCVIds.length === 0}
          >
            Match Selected ({selectedCVIds.length})
          </Button>
          <Button
            size="sm"
            onClick={handleMatchAll}
            disabled={completedCVs.length === 0}
          >
            Match All CVs ({completedCVs.length})
          </Button>
        </div>
        {/* Explicit user guidance for M-01b workflow */}
        <p className="text-xs text-muted-foreground">
          To match specific CVs: Use the checkboxes in the Queue panel (left) to select CVs, then click "Match Selected".
        </p>
      </div>

      {/* Results list */}
      <div className="flex-1 overflow-y-auto p-2">
        {matchResults.length === 0 ? (
          <div className="p-4 text-center text-muted-foreground">
            <p>No match results yet.</p>
            <p className="text-sm mt-1">Match CVs against this JD to see rankings.</p>
          </div>
        ) : (
          <div className="space-y-2">
            {matchResults.map((result, index) => {
              const quality = getMatchQuality(result.match_score);
              return (
                <div
                  key={result.cv_id}
                  className="p-3 rounded-md border border-border hover:border-muted-foreground
                             cursor-pointer transition-colors"
                  onClick={() => loadCV(result.cv_id)}
                >
                  <div className="flex items-center justify-between">
                    <div className="flex items-center gap-2">
                      <span className="text-lg font-bold text-muted-foreground w-6">
                        #{index + 1}
                      </span>
                      <span className="font-medium text-foreground truncate">
                        {getCVFileName(result.cv_id)}
                      </span>
                    </div>
                    <div className="flex items-center gap-2">
                      <span
                        className={`
                          text-lg font-bold
                          ${quality.color === 'green' ? 'text-green-500' : ''}
                          ${quality.color === 'yellow' ? 'text-yellow-500' : ''}
                          ${quality.color === 'orange' ? 'text-orange-500' : ''}
                          ${quality.color === 'red' ? 'text-red-500' : ''}
                        `}
                      >
                        {result.match_score}%
                      </span>
                      <Badge
                        variant="outline"
                        className={`
                          ${quality.color === 'green' ? 'border-green-500 text-green-500' : ''}
                          ${quality.color === 'yellow' ? 'border-yellow-500 text-yellow-500' : ''}
                          ${quality.color === 'orange' ? 'border-orange-500 text-orange-500' : ''}
                          ${quality.color === 'red' ? 'border-red-500 text-red-500' : ''}
                        `}
                      >
                        {quality.label}
                      </Badge>
                    </div>
                  </div>

                  <div className="mt-2 text-xs text-muted-foreground">
                    <span className="text-green-500">
                      {result.matched_skills.length} matched
                    </span>
                    {result.missing_required.length > 0 && (
                      <span className="ml-2 text-red-500">
                        {result.missing_required.length} required missing
                      </span>
                    )}
                  </div>

                  {/* Show matched skills preview */}
                  {result.matched_skills.length > 0 && (
                    <div className="mt-2 flex flex-wrap gap-1">
                      {result.matched_skills.slice(0, 5).map((skill) => (
                        <span
                          key={skill}
                          className="px-1.5 py-0.5 bg-primary/20 text-primary text-xs rounded"
                        >
                          {skill}
                        </span>
                      ))}
                      {result.matched_skills.length > 5 && (
                        <span className="text-xs text-muted-foreground">
                          +{result.matched_skills.length - 5} more
                        </span>
                      )}
                    </div>
                  )}
                </div>
              );
            })}
          </div>
        )}
      </div>
    </div>
  );
}
```

**3. Create `src/renderer/components/jd/JDPanel.tsx`:**

```tsx
import { Tabs, TabsContent, TabsList, TabsTrigger } from '../ui/tabs';
import { JDInput } from './JDInput';
import { JDList } from './JDList';
import { MatchResults } from './MatchResults';
import { useJDStore } from '../../stores/jdStore';

export function JDPanel() {
  const { activeJD } = useJDStore();

  return (
    <div className="h-full flex flex-col">
      <Tabs defaultValue="jds" className="flex-1 flex flex-col">
        <div className="border-b border-border px-4">
          <TabsList className="bg-transparent">
            <TabsTrigger
              value="jds"
              className="data-[state=active]:bg-muted"
            >
              Job Descriptions
            </TabsTrigger>
            <TabsTrigger
              value="add"
              className="data-[state=active]:bg-muted"
            >
              Add JD
            </TabsTrigger>
            <TabsTrigger
              value="results"
              className="data-[state=active]:bg-muted"
              disabled={!activeJD}
            >
              Match Results
              {activeJD && (
                <span className="ml-1 text-xs text-muted-foreground">
                  ({activeJD.title.substring(0, 15)}...)
                </span>
              )}
            </TabsTrigger>
          </TabsList>
        </div>

        <TabsContent value="jds" className="flex-1 overflow-y-auto mt-0">
          <JDList />
        </TabsContent>

        <TabsContent value="add" className="flex-1 overflow-y-auto mt-0">
          <JDInput />
        </TabsContent>

        <TabsContent value="results" className="flex-1 overflow-hidden mt-0">
          <MatchResults />
        </TabsContent>
      </Tabs>
    </div>
  );
}
```

**4. Update `src/renderer/components/jd/index.ts`:**

```typescript
export { JDInput } from './JDInput';
export { JDList } from './JDList';
export { JDPanel } from './JDPanel';
export { MatchResults } from './MatchResults';
export { SkillHighlight, HighlightedSkillBadge } from './SkillHighlight';
```
  </action>
  <verify>
```bash
cd "C:\Users\edwar\Documents\dev\Projects\Samsara"
# Verify all components compile
npx tsc --noEmit src/renderer/components/jd/*.tsx 2>&1 | head -20

# Verify exports
grep -n "export" src/renderer/components/jd/index.ts

# Verify MatchResults uses queueStore selectedIds (M-01b key link)
grep -n "selectedIds\|useQueueStore" src/renderer/components/jd/MatchResults.tsx | head -5
```
  </verify>
  <done>
- JDList component displays stored JDs with selection and delete
- MatchResults component shows ranked CVs with scores, quality badges, matched skills preview
- MatchResults explicitly integrates with queueStore.selectedIds for CV selection (M-01b)
- User guidance text explains the checkbox workflow
- JDPanel combines tabs for JD list, add JD, and match results
- All components use existing UI primitives (Button, Badge, Tabs)
- Index exports all JD components
  </done>
</task>

<task type="auto">
  <name>Task 3: Integrate into App layout and update SkillsSection for highlighting</name>
  <files>
    src/renderer/App.tsx
    src/renderer/components/editor/SkillsSection.tsx
  </files>
  <action>
**1. Update `src/renderer/App.tsx`:**

Add JD panel to the layout. The app should now have three columns when JD matching is active:
- Left: Queue
- Middle: JD Panel
- Right: CV Editor (when viewing a CV)

```tsx
import { useEffect } from 'react';
import { QueueTabs } from './components/queue/QueueTabs';
import { CVEditor } from './components/editor/CVEditor';
import { ErrorDetailPanel } from './components/editor/ErrorDetailPanel';
import { JDPanel } from './components/jd/JDPanel';
import { useQueueStore } from './stores/queueStore';
import { useEditorStore } from './stores/editorStore';
import { useJDStore } from './stores/jdStore';
import './styles/globals.css';

export function App() {
  const loadFromDatabase = useQueueStore((state) => state.loadFromDatabase);
  const loadJDs = useJDStore((state) => state.loadJDs);
  const viewMode = useEditorStore((state) => state.viewMode);

  // Load existing CVs and JDs from database on mount
  useEffect(() => {
    loadFromDatabase();
    loadJDs();
  }, [loadFromDatabase, loadJDs]);

  const isPanelOpen = viewMode !== null;

  return (
    <div className="h-screen flex flex-col bg-background">
      {/* Header */}
      <header className="flex items-center justify-between px-4 py-2 border-b border-border">
        <div>
          <h1 className="text-lg font-bold text-primary">Samsara</h1>
        </div>
      </header>

      {/* Main content - three column layout */}
      <main className="flex-1 overflow-hidden flex">
        {/* Queue panel - left side */}
        <div className={`border-r border-border ${isPanelOpen ? 'w-1/3' : 'w-1/2'}`}>
          <QueueTabs />
        </div>

        {/* JD panel - middle */}
        <div className={`border-r border-border ${isPanelOpen ? 'w-1/3' : 'w-1/2'}`}>
          <JDPanel />
        </div>

        {/* Detail panel - right side (CV editor or error details) */}
        {viewMode === 'cv' && (
          <div className="w-1/3">
            <CVEditor />
          </div>
        )}
        {viewMode === 'error' && (
          <div className="w-1/3">
            <ErrorDetailPanel />
          </div>
        )}
      </main>
    </div>
  );
}
```

**2. Update `src/renderer/components/editor/SkillsSection.tsx`:**

Add skill highlighting when a JD is active:

```tsx
import { useJDStore } from '../../stores/jdStore';
import { HighlightedSkillBadge } from '../jd/SkillHighlight';
import type { SkillGroup } from '../../types/cv';

interface SkillsSectionProps {
  skills: SkillGroup[];
}

export function SkillsSection({ skills }: SkillsSectionProps) {
  const { activeJD, matchResults } = useJDStore();
  const { activeCVId } = useEditorStore();

  // Get matched skills for the current CV if viewing in JD context
  const currentMatch = matchResults.find(r => r.cv_id === activeCVId);
  const matchedSkills = currentMatch?.matched_skills || [];

  // Determine if we should highlight (JD is active)
  const shouldHighlight = activeJD !== null && matchedSkills.length > 0;

  if (skills.length === 0) {
    return (
      <section className="space-y-2">
        <h3 className="text-sm font-semibold text-muted-foreground uppercase tracking-wide">
          Skills
        </h3>
        <p className="text-sm text-muted-foreground italic">No skills extracted</p>
      </section>
    );
  }

  return (
    <section className="space-y-3">
      <div className="flex items-center justify-between">
        <h3 className="text-sm font-semibold text-muted-foreground uppercase tracking-wide">
          Skills
        </h3>
        {shouldHighlight && (
          <span className="text-xs text-primary">
            Highlighting matches for: {activeJD.title}
          </span>
        )}
      </div>

      {skills.map((group, groupIndex) => (
        <div key={groupIndex} className="space-y-1">
          <h4 className="text-xs font-medium text-muted-foreground">
            {group.category}
          </h4>
          <div className="flex flex-wrap gap-1">
            {group.skills.map((skill, skillIndex) => (
              shouldHighlight ? (
                <HighlightedSkillBadge
                  key={skillIndex}
                  skill={skill}
                  matchedSkills={matchedSkills}
                />
              ) : (
                <span
                  key={skillIndex}
                  className="inline-flex items-center px-2 py-0.5 rounded text-xs
                             font-medium bg-muted text-muted-foreground"
                >
                  {skill}
                </span>
              )
            ))}
          </div>
        </div>
      ))}

      {/* Show missing required skills if viewing in JD context */}
      {shouldHighlight && currentMatch && currentMatch.missing_required.length > 0 && (
        <div className="mt-4 p-3 rounded-md border border-destructive/30 bg-destructive/5">
          <h4 className="text-xs font-medium text-destructive mb-2">
            Missing Required Skills
          </h4>
          <div className="flex flex-wrap gap-1">
            {currentMatch.missing_required.map((skill, index) => (
              <span
                key={index}
                className="inline-flex items-center px-2 py-0.5 rounded text-xs
                           font-medium bg-destructive/20 text-destructive"
              >
                {skill}
              </span>
            ))}
          </div>
        </div>
      )}
    </section>
  );
}

// Add missing import at top
import { useEditorStore } from '../../stores/editorStore';
```
  </action>
  <verify>
```bash
cd "C:\Users\edwar\Documents\dev\Projects\Samsara"
# Full build test
npm run build 2>&1 | tail -20

# Verify App includes JDPanel
grep -n "JDPanel" src/renderer/App.tsx

# Verify SkillsSection uses highlighting
grep -n "HighlightedSkillBadge\|matchedSkills" src/renderer/components/editor/SkillsSection.tsx | head -10
```
  </verify>
  <done>
- App.tsx updated with three-column layout (Queue | JD Panel | CV Editor)
- SkillsSection.tsx enhanced with JD-aware skill highlighting
- Missing required skills shown when viewing CV in JD context
- Highlighting indicator shows which JD is active
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete JD Matching feature (Phase 4):
1. JD input with LLM extraction of requirements (paste OR file upload)
2. JD list with selection and management
3. Matching algorithm with 70/30 weighted scoring
4. Ranked results view with match quality indicators
5. CV selection via queue checkboxes (M-01b workflow)
6. Skill highlighting in CV editor when viewing against a JD
  </what-built>
  <how-to-verify>
**Test the complete JD matching flow:**

1. **Start the app:** `npm start`

2. **Add a Job Description:**
   - Click "Add JD" tab in the JD panel (middle column)
   - Paste a sample JD text (e.g., from a job posting) OR click "Upload .txt File"
   - Click "Extract Requirements"
   - Wait for LLM processing (30-60 seconds)
   - Verify JD appears in "Job Descriptions" tab with title and skill counts

3. **Process some CVs (if not already in queue):**
   - Drag-drop CV files into the queue
   - Wait for processing to complete

4. **Test CV Selection (M-01b):**
   - In the Queue panel (LEFT side), use the checkboxes to select specific CVs
   - Notice the "Match Selected (N)" button in Match Results shows the count
   - This confirms the queueStore.selectedIds integration is working

5. **Match CVs against JD:**
   - Select the JD in "Job Descriptions" tab
   - Click "Match Selected" to match only checked CVs, OR
   - Click "Match All CVs" to match all completed CVs
   - Verify ranked list appears with:
     - Position numbers (#1, #2, etc.)
     - Match percentage (0-100%)
     - Quality badge (Strong/Good/Partial/Weak Match)
     - Matched skills preview

6. **View CV with highlighting:**
   - Click on a CV in the match results
   - CV editor opens on the right
   - Verify Skills section shows:
     - Matched skills highlighted with asterisk
     - "Missing Required Skills" section if any
     - Indicator showing which JD is active

7. **Verify UI is responsive:**
   - Three columns display correctly
   - Scrolling works in each panel
   - Selection state is visible

**Expected behavior:**
- JD extraction takes 30-60 seconds (LLM processing)
- JD can be added via paste OR file upload (M-01a)
- CV selection uses queue checkboxes (M-01b)
- Matching calculation is near-instant
- Strong matches (75%+) show green indicators
- Skills that match JD requirements are visually highlighted
  </how-to-verify>
  <resume-signal>Type "approved" if the JD matching feature works correctly, or describe any issues found.</resume-signal>
</task>

</tasks>

<verification>
After all tasks complete and checkpoint approved:

1. **Build**: `npm run build` passes without errors
2. **Visual**: Three-column layout renders correctly
3. **JD Flow**: Paste OR Upload -> Extract -> List -> Select -> Match -> Results
4. **CV Selection**: Queue checkboxes -> selectedIds -> Match Selected button
5. **Highlighting**: Skills highlighted when viewing CV against selected JD
6. **Match Quality**: Scores and labels match expected behavior

Requirements fulfilled:
- M-01a: User can paste or upload a Job Description (BOTH implemented)
- M-01b: User can select multiple CVs to rate against a JD (via queue checkboxes)
- M-01c: System scores each CV against the JD (% match)
- M-01d: CVs appear ranked by match score
- M-01e: Matching skills are highlighted in the CV view
</verification>

<success_criteria>
- [ ] react-highlight-words installed and working
- [ ] SkillHighlight and HighlightedSkillBadge components created
- [ ] JDList shows stored JDs with selection
- [ ] JDPanel with tabs for list, add, and results
- [ ] MatchResults shows ranked CVs with scores and quality indicators
- [ ] MatchResults reads selectedIds from queueStore for CV selection (M-01b)
- [ ] App.tsx integrates JDPanel in three-column layout
- [ ] SkillsSection highlights matched skills when JD is active
- [ ] Human verification checkpoint passed
- [ ] All M-01 requirements satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/04-jd-matching/04-03-SUMMARY.md`
</output>
